# Quantum entanglement {#chapter5}

> On ... **!!!TODO!!!**

We now know everything we need to know about a single qubit and its quantum behaviour.
But if we want to understand quantum computation --- a complicated quantum interference of many interacting qubits --- then we will need few more mathematical tools.
Stepping up from one qubit to two or more is a bigger leap than you might expect.
Already, with just two qubits, we will encounter the remarkable phenomenon of quantum entanglement and have a chance to discuss some of the most puzzling features of quantum theory that took people decades to understand.





## A small history

The notion of **quantum entanglement** was the subject of many early debates that focused on the meaning of quantum theory.
Back in the 1930s, Albert Einstein, Niels Bohr, Werner Heisenberg, and Erwin Schrodinger (to mention just the usual suspects) were trying hard to understand its conceptual consequences.^[E. Schrodinger, Discussion of probability relations between separated system, _Mathematical Proceedings of the Cambridge Philosophical Society_ **31** (1935), pp. 555--563.]
Einstein, the most sceptical of them all, claimed that it was pointing toward the fatal flaw in quantum theory, and referred to it as "_spooky action-at-a-distance_".
In contrast, SchrÃ¶dinger was much more prepared to accept quantum theory exactly as it was formulated, along with all its predictions, no matter how weird they might be.
In his 1935 paper, which introduced quantum entanglement, he wrote "I would not call it _one_ but rather _the_ characteristic trait of quantum mechanics, the one that enforces its entire departure from classical lines of thought".
Today we still talk a lot about quantum entanglement, but more often it is viewed as a physical resource which enables us to communicate with perfect security, build very precise atomic clocks, and even teleport small quantum objects!
But what exactly is quantum entanglement?





## One, two, many...

In classical physics, the transition from a single object to a composite system of many objects is trivial: in order to describe the state of, say, 42 objects at any given moment of time, it is sufficient to describe the state of each of the objects separately.
Indeed, the classical state of 42 point-like particles is described by specifying the position and the momentum of each particle.

::: {.idea data-latex=""}
In the _classical_ world, "the whole is the sum of its parts", but the _quantum_ world is very different.
:::

Consider, for example, a pair of qubits.
Suppose that each one is described by a state vector: the first one by $\ket{a}$, and the second one by $\ket{b}$.
One might therefore think that the most general state of the two qubits should be represented by a pair of state vectors, $\ket{a}\ket{b}$, with one for each qubit.
Indeed, such a state is certainly possible, but there are other states that _cannot_ be expressed in this form.
In order to write down the most general state of two qubits we first focus on the basis states.

For a single qubit we have been using the standard basis $\{\ket{0},\ket{1}\}$.
For two qubits we may choose the following as our standard basis states:^[It looks like we are defining some sort of "multiplication rule" for kets here, saying that $\ket{a}\ket{b}:=\ket{ab}$. This is indeed the case, but to talk about this properly we need to introduce the idea of **tensor products** (which we do very soon).]
$$
  \begin{array}{cc}
    \ket{00} \equiv \ket{0}\ket{0}
    & \ket{01} \equiv \ket{0}\ket{1}
  \\\ket{10} \equiv \ket{1}\ket{0}
    &\ket{11} \equiv \ket{1}\ket{1}.
  \end{array}
$$
Within each ket, the first symbol refers to the first qubit, and the second to the second, and we have tacitly assumed that we can distinguish the two qubits by their location, or some other means.
Now, the most general state of the two qubits is a normalised linear combination of these four basis states, i.e. a vector of the form
$$
  \ket{\psi}
  = c_{00}\ket{00} + c_{01}\ket{01} + c_{10}\ket{10} + c_{11}\ket{11}.
$$
Physical interpretation aside, let us count how many real parameters are needed to specify this state.
Six, right?
We have four complex numbers (eight real parameters) restricted by the normalisation condition, along with the fact that states differing only by a global phase factor are equivalent, which leaves us with six real parameters.
Now, by the same line of argument, we need only two real parameters to specify the state of a single qubit, and hence need four real parameters to specify any state of two qubits of the form $\ket{a}\ket{b}$.
So it cannot be the case that every state of two qubits can be expressed as a pair of states $\ket{a}\ket{b}$, simply for "dimension reasons".

For example, compare the two states of two qubits,
$$
  \begin{gathered}
    \frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{01}
  \\\mbox{and}
  \\\frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{11}.
  \end{gathered}
$$
The first one is **separable**, i.e. we can view it as a pair of state vectors where each one pertains to one of the two qubits:
$$
  \frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{01}
  = \underbrace{\vphantom{\frac{1}{\sqrt 2}}\ket{0}}_{\text{qubit 1}}
  \;\;
  \underbrace{\frac{1}{\sqrt 2}(\ket{0}+\ket{1})}_{\text{qubit 2}},
$$
The second state, however, does _not_ admit such a decomposition: there do _not_ exist any $\psi_1,\psi_2$ such that
$$
  \frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{11}
  =
  \ket{\psi_1}\ket{\psi_2}
$$
and so we say that it is an **entangled** state.
Informally, any bipartite state that cannot be viewed as a pair of two states pertaining to the constituent subsystems is said to be entangled.

With this discussion in our minds, we can now give more formal account of the states of composite quantum systems.





## Quantum theory, formally (continued)

Recalling [Chapter 4](#chapter4), where we said that we were missing a key part of the formalism of quantum theory, we can now fill in this hole.
Our mathematical formalism of choice behind the quantum theory of composite systems is based on the **tensor product** of Hilbert spaces.

### Tensor products

Let the states of some system $\mathcal{A}$ be described by vectors in an $n$-dimensional Hilbert space $\mathcal H_A$, and the states of some system $\mathcal{B}$ by vectors in an $m$-dimensional Hilbert space $\mathcal H_B$.
The combined system of $\mathcal{A}$ and $\mathcal{B}$ is then described by vectors in the $(nm)$-dimensional **tensor product space** $\mathcal{H}_A\otimes\mathcal{H}_B$.
Given bases $\{\ket{a_1},\ldots,\ket{a_n}\}$ of $\mathcal H_A$ and $\{\ket{b_1},\ldots,\ket{b_m}\}$ of $\mathcal H_B$, we form a basis of the tensor product by taking the ordered pairs $\ket{a_i}\otimes\ket{b_j}$, for $i=1,\ldots,n$ and $j=1,\ldots,m$.
The tensor product space $\mathcal{H}_A\otimes\mathcal{H}_B$ then consists of all linear combination of such tensor product basis vectors:^[If the bases $\{\ket{a_i}\}$ and $\{\ket{b_j}\}$ are orthonormal then so too is the tensor product basis $\{\ket{a_i}\otimes\ket{b_j}\}$.]
\begin{equation}
  \ket{\psi}
  = \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j}.
(\#eq:bipartite)
\end{equation}

The tensor product operation $\otimes$ is distributive:
$$
  \begin{gathered}
    \ket{a} \otimes \left( \beta_1\ket{b_1} + \beta_2\ket{b_2} \right)
    = \beta_1\ket{a}\otimes\ket{b_1} + \beta_2\ket{a}\otimes\ket{b_2}
  \\\left( \alpha_1\ket{a_1} + \alpha_2\ket{a_2} \right) \otimes \ket{b}
    = \alpha_1\ket{a_1}\otimes\ket{b} + \alpha_2\ket{a_2}\otimes\ket{b}.
  \end{gathered}
$$
The tensor product of Hilbert spaces is again a Hilbert space: the inner products on $\mathcal{H}_A$ and $\mathcal{H}_B$ give a natural inner product on $\mathcal{H}_A\otimes\mathcal{H}_B$, defined for any two product vectors by^[The bra corresponding to the tensor product state $\ket{a}\otimes\ket{b}$ is written as $(\ket{a}\otimes\ket{b})^\dagger = \bra{a}\otimes\bra{b}$, where the order of the factors on either side of $\otimes$ does not change when the dagger operation is applied.]
$$
  \left( \bra{a'}\otimes\bra{b'} \right) \left( \ket{a}\otimes\ket{b} \right)
  = \braket{a'|a}\braket{b'|b}
$$
and extended by linearity to sums of tensor products of vectors, and by associativity^[$({\mathcal{H}}_a \otimes {\mathcal{H}}_b)\otimes {\mathcal{H}}_c = {\mathcal{H}}_a \otimes ({\mathcal{H}}_b\otimes {\mathcal{H}}_c)$.] to any number of subsystems.

Some joint states of $\mathcal{A}$ and $\mathcal{B}$ can be expressed as a single tensor product, say $\ket{\psi}=\ket{a}\otimes\ket{b}$ (often written as $\ket{a}\ket{b}$, or $\ket{a, b}$, or even $\ket{ab}$), meaning that the subsystem $\mathcal{A}$ is in state $\ket{a}$, and the subsystem $\mathcal{B}$ in state $\ket{b}$.
If we expand $\ket{a}=\sum_i\alpha_i\ket{a_i}$ and $\ket{b}=\sum_i\beta_j\ket{b_j}$, then $\ket{\psi}=\sum_{ij}\alpha_i\beta_j\ket{a_i}\otimes\ket{b_j}$ and we see that, for all such states, the coefficients $c_{ij}$ in Equation \@ref(eq:bipartite) are of a rather special form:
$$
  c_{ij} = \alpha_i\beta_j.
$$
We call such states **separable** (or just **product states**).
States that are not separable are said to be **entangled**.

A useful fact about tensor products is that $\lambda a\otimes b = a\otimes\lambda b$ (where $a$ and $b$ are vectors, and $\lambda$ is a scalar).
This means that we don't need to worry about brackets and write something like $\lambda(a\otimes b)$.

We will also need the concept of the tensor product of two operators.
If $A$ is an operator on $\mathcal{H}_A$ and $B$ an operator on $\mathcal{H}_B$, then the tensor product operator $A\otimes B$ is an operator on $\mathcal{H}_A\otimes\mathcal{H}_B$ defined by its action on product vectors via
$$
  (A\otimes B)(\ket{a}\otimes\ket{b}) = (A\ket{a})\otimes (B\ket{b})
$$
and with its action on all other vectors determined by linearity:
$$
  A\otimes B \left( \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j} \right)
  = \sum_{ij}c_{ij} A\ket{a_i}\otimes B\ket{b_j}.
$$






## Back to qubits

Let's see how this formalism works for qubits.
The $n$-fold tensor product of vectors from the standard basis $\{\ket{0},\ket{1}\}$ represent binary strings of length $n$.
For example, for $n=3$,^[We often drop the $\otimes$ symbol, especially when we deal with the standard tensor product basis. For example, a state of a quantum register composed of four qubits holding the binary string $1001$ may be written as $\ket{1}\otimes\ket{0}\otimes\ket{0}\otimes\ket{1}$, as $\ket{1}\ket{0}\ket{0}\ket{1}$, or even simply as $\ket{1001}$.]
$$
  \begin{aligned}
    \ket{0}\otimes\ket{1}\otimes\ket{1}
    & \equiv \ket{011}
  \\\ket{1}\otimes\ket{1}\otimes\ket{1}
    & \equiv \ket{111}.
  \end{aligned}
$$
A _classical_ register composed of three bits can store _only one_ of these two binary strings at any time; a _quantum_ register composed of three qubits can store _both of them_ in a superposition.

Indeed, if we start with the state $\ket{011}$ and apply the Hadamard gate to the first qubit (which is the same as applying $H\otimes\id\otimes\id$), then, given that linear combinations distribute over tensor products, we obtain^[We often simply write $H\otimes H\otimes H$ as $H^{\otimes 3}$.]
$$
  \begin{aligned}
    \ket{011}
    \longmapsto
    &\frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big) \otimes\ket{1}\otimes\ket{1}
  \\\equiv
    &\frac{1}{\sqrt2} \big(\ket{011} + \ket{111}\big).
  \end{aligned}
$$
In fact, we can even prepare this register in a superposition of all eight possible binary strings: if we apply the tensor product operation $H\otimes H\otimes H$ to the state $\ket{0}\otimes\ket{0}\otimes\ket{0} = \ket{000}$ then we get

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=6}
\begin{equation*}
  \left.
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
  \end{quantikz}
  \right\}
  =
  \frac{1}{2^{3/2}}
  \left\{
    \begin{array}{r}
      \ket{000} + \ket{001} + \ket{010} + \ket{011}
    \\ + \ket{100} + \ket{101} + \ket{110} + \ket{111}
    \end{array}
  \right\}.
\end{equation*}
```

The resulting state is exactly a superposition of all binary string of length 3, and can also be written as
$$
  \frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big)
  \otimes
  \frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big)
  \otimes
  \frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big).
$$

In general, the tensor product operation $H^{\otimes n}$, which means "apply the Hadamard gate to each of your $n$ qubits", is known as the **Hadamard transform**, and it maps product states to product states.
Like the Hadamard gate in the typical quantum interference circuit, the Hadamard transform opens and closes a multi-qubit interference.






## Separable or entangled?

::: {.idea data-latex=""}
_Most_ vectors in $\mathcal{H}_a\otimes \mathcal{H}_b$ are entangled and _cannot_ be written as product states $\ket{a}\otimes\ket{b}$ with $\ket{a}\in\mathcal{H}_a$ and $\ket{b}\in\mathcal{H}_b$.
:::

In order to see this, let us write any joint state $\ket{\psi}$ of $\mathcal{A}$ and $\mathcal{B}$ in a product basis as
\begin{equation}
  \begin{aligned}
    \ket{\psi}
    &= \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j}
  \\&= \sum_i\ket{a_i}\otimes\left(\sum_j c_{ij}\ket{b_j}\right)
  \\&= \sum_i\ket{a_i}\otimes\ket{\phi_i}
  \end{aligned}
(\#eq:bipartite2)
\end{equation}
where the $\ket{\phi_i}=\sum_j c_{ij}\ket{b_j}$ are vectors in $\mathcal{H}_B$ that need not be normalised.
For any _product_ state, these vectors have a special form.
Indeed, if $\ket{\psi}= \ket{a}\otimes\ket{b}$ then, after expanding the first state in the $\ket{a_i}$ basis, we obtain
$$
  \ket{\psi}
  = \sum_{i}\ket{a_i}\otimes\left(\sum_i\alpha_i\ket{b}\right).
$$
This expression has the same form as Equation \@ref(eq:bipartite2) with $\ket{\phi_i}=\alpha_i\ket{b}$, i.e. each of the $\ket{\phi_i}$ vectors in this expansion is a multiple of the same vector $\ket{b}$.
Conversely, if $\ket{\phi_i} = \alpha_i\ket{b}$ for all $i$ in Equation \@ref(eq:bipartite2), then $\ket{\psi}$ must be a product state.^[Even though an entangled state cannot be written as a tensor product, it can always be written as a linear combination of vectors from the tensor product basis. In fact, any state of $n$ qubits $\ket{\psi}$ can be expressed in the standard _product_ basis. In general, given $n$ qubits, we need $2(2^n-1)$ real parameters to describe their state vector, but only $2n$ to describe separable states.]
So if we want to identify which joint states are product states and which are not, we simply write the joint state according to Equation \@ref(eq:bipartite2) and check if all the vectors $\ket{\phi_i}$ are multiples of a single vector.
Needless to say, if we choose the states $\ket{\phi}$ randomly, it is very unlikely that this condition is satisfied, and we almost certainly pick an entangled state.

Quantum entanglement is one of the most fascinating aspects of quantum theory.
We will now explore some of its implications.






## Controlled-NOT

How do entangled states arise in real physical situations?
The short answer is that _entanglement is the result of interactions_.
It is easy to see that tensor product operations $U_1\otimes\ldots U_n$ map product states to product states:

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=6}
\begin{equation*}
  \left.
    \begin{quantikz}
      \lstick{$\ket{\psi_1}$}
      & \gate{U_1}
      & \qw \rstick{$\ket{\psi'_1}$}
    \\[-1em]
      &\vdots&
    \\[-0.5em]
      \lstick{$\ket{\psi_n}$}
      & \gate{U_n}
      & \qw \rstick{$\ket{\psi'_n}$}
    \end{quantikz}
  \right\}
  \ket{\psi'_1}\otimes\ldots\otimes\ket{\psi'_n}
\end{equation*}
```

and so any collection of separable qubits remains separable.

As soon as qubits start interacting with one another, however, they become entangled, and things start to get really interesting.
We will describe interactions that cannot be written as tensor products of unitary operations on individual qubits.
The most popular two-qubit entangling gate is the **controlled-$\texttt{NOT}$** (or $\texttt{c-NOT}$), also known as the **controlled-$X$** gate.^[Here the $X$ refers to the Pauli operator $\sigma_x\equiv X$ that implements the bit-flip.]
The gate acts on two qubits: it flips the second qubit (referred to as the **target**) if the first qubit (referred to as the **control**) is $\ket{1}$, and does nothing if the control qubit is $\ket{0}$.
In the standard basis^[Recall that the standard, or **computational**, basis is $\{\ket{00},\ket{01},\ket{10},\ket{11}\}$.], it is represented by the following unitary matrix:

::: {.idea data-latex=""}
| controlled-$\texttt{NOT}$ |
| :--------------: |
| $\left[\begin{array}{c|c}\begin{matrix}1&0\\0&1\end{matrix}&\begin{matrix}0&0\\0&0\end{matrix}\\\hline\begin{matrix}0&0\\0&0\end{matrix}&\begin{matrix}0&1\\1&0\end{matrix}\end{array}\right]$ |
:::

We can also represent the $\texttt{c-NOT}$ gate using the circuit notation, as in \@ref(fig:c-not-diagram).

(ref:c-not-diagram-caption) Where $x,y\in\{0,1\}$, and $\oplus$ denotes $\texttt{XOR}$, or addition modulo 2.

```{r c-not-diagram,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.cap='(ref:c-not-diagram-caption)'}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{x}$}
    & \ctrl{1}
    & \qw \rstick{$\ket{x}$}
  \\\lstick{$\ket{y}$}
    & \targ \qw
    & \qw \rstick{$\ket{x\oplus y}$}
  \end{quantikz}
\end{equation*}
```

Note that this gate does not admit any tensor product decomposition, but can be written as a sum of tensor products:^[Make sure that you understand how the Dirac notation is used here. More generally, think why $$\proj{0}\otimes A + \proj{1}\otimes B$$ means "_if the first qubit is in state $\ket{0}$ then apply $A$ to the second one, and if the first qubit is in state $\ket{1}$ then apply $B$ to the second one_". What happens if the first qubit is in a superposition of $\ket{0}$ and $\ket{1}$?]
$$
  \texttt{c-NOT}
  = \proj{0}\otimes\id + \proj{1}\otimes X
$$
where $X$ is the Pauli bit-flip operation.

The $\texttt{c-NOT}$ gate lets us do many interesting things, and can act in a rather deceptive way.
Let us now study some of these things.






### The Bell states, and the Bell measurement

We start with the generation of entanglement.
Here is a simple circuit that demonstrates the entangling power of $\texttt{c-NOT}$:^[John Stewart Bell (1928--1990) was a Northern Irish physicist.]

:::: {.circuit data-latex=""}
::: {.circuit_title}
(Generating entanglement).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{1}
    & \qw \rstick[wires=2]{$\frac{1}{\sqrt2}(\ket{00}+\ket{11})$}
  \\\lstick{$\ket{0}$}
    & \qw
    & \targ \qw
    & \qw
  \end{quantikz}
\end{equation*}
```
::::

In this circuit, the separable input $\ket{0}\ket{0}$ evolves as
$$
  \begin{aligned}
    \ket{0}\ket{0}
    \xmapsto{H}& \frac{1}{\sqrt2} (\ket{0} + \ket{1}) \ket{0}
  \\=& \frac{1}{\sqrt2}\ket{0}\ket{0} + \frac{1}{\sqrt2}\ket{1}\ket{0}
  \\\xmapsto{\texttt{c-NOT}}& \frac{1}{\sqrt2}\ket{0}\ket{0} + \frac{1}{\sqrt2}\ket{1}\ket{1}
  \end{aligned}
$$
resulting in the entangled output $\frac{1}{\sqrt 2}(\ket{00}+\ket{11})$.
In fact, this circuit implements the unitary operation which maps the standard computational basis into the four entangled states, known as the **Bell states**.

::: {.idea data-latex=""}
The **Bell states**, $\ket{\psi_{ij}}$, as generated by the above circuit:
$$
  \begin{aligned}
    \ket{00}
    &\mapsto
    \ket{\psi_{00}} = \frac{1}{\sqrt 2}(\ket{00}+\ket{11})
  \\\ket{01}
    &\mapsto
    \ket{\psi_{01}} = \frac{1}{\sqrt 2}(\ket{01}+\ket{10})
  \\\ket{10}
    &\mapsto
    \ket{\psi_{10}} = \frac{1}{\sqrt 2}(\ket{00}-\ket{11})
  \\\ket{11}
    &\mapsto
    \ket{\psi_{11}} = \frac{1}{\sqrt 2}(\ket{01}-\ket{10})
  \end{aligned}
$$
:::

The Bell states form an orthonormal basis in the Hilbert space $\mathcal{H}_1\otimes\mathcal{H}_2$ of two qubits.
We can perform measurements in the Bell basis: the easiest way to do it in practice is to "rotate" the Bell basis to the standard basis, and then perform the measurement in the standard basis.^[For any state $\ket{\psi}$ of two qubits, the amplitude $\braket{\psi_{xy}|\psi}$ can be written as $\braket{xy|U^\dagger|\psi}$, where $U^\dagger$ is such that $\ket{\psi_{xy}} = U\ket{xy}$.]
Indeed, if we reverse the circuit, then we get a circuit which maps the Bell state $\ket{\psi_{xy}}$ to the corresponding state $\ket{xy}$ in the standard basis.
This unitary mapping allows us to "implement" the projections on Bell states by applying the reversed circuit followed by the usual qubit-by-qubit measurement in the standard basis.






### Quantum teleportation

A wonderful fact, that sounds more like science fiction than actual science, is the following: _an unknown quantum state can be teleported from one location to another._
Consider the following circuit:^[_Divide et impera_, or "divide and conquer": a good approach to solving problems in mathematics (and in life). Start with smaller circuits, those surrounded by the dashed boxes.]

:::: {.circuit data-latex=""}
::: {.circuit_title}
(Quantum teleportation).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\alpha\ket{0}+\beta\ket{1}$}
    & \qw
    & \qw
    & \ctrl{1} \gategroup[wires=2,steps=2,style={inner sep=0.1em,dashed,rounded corners}]{}
    & \gate{H}
    & \qw \rstick{$\ket{x}$}
  \\\lstick{$\ket{0}$}
    & \gate{H} \gategroup[wires=2,steps=2,style={inner sep=0.1em,dashed,rounded corners}]{}
    & \ctrl{1}
    & \targ \qw
    & \qw
    & \qw \rstick{$\ket{y}$}
  \\\lstick{$\ket{0}$}
    & \qw
    & \targ \qw
    & \qw
    & \qw
    & \qw \rstick{$\ket{\psi}$}
  \end{quantikz}
\end{equation*}
```
::::

The first input qubit (counting from the top) is in some arbitrary state.
After the action of the part of the circuit in the first dashed box (counting from the left), the state of the three qubits reads^[We neglect to write the normalisation factors.]
$$
  \big( \alpha\ket{0}+\beta\ket{1} \big)
  \big( \ket{00}+\ket{11} \big).
$$
By regrouping the terms, but keeping the qubits in the same order, this state can be written as the sum
$$
  \begin{aligned}
    &(\ket{00} + \ket{11}) \otimes (\alpha\ket{0} + \beta\ket{1})
  \\+ &(\ket{01} + \ket{10}) \otimes (\alpha\ket{1} + \beta\ket{0})
  \\+ &(\ket{00} - \ket{11}) \otimes (\alpha\ket{0} - \beta\ket{1})
  \\+ &(\ket{01} - \ket{10}) \otimes (\alpha\ket{1} - \beta\ket{0}).
  \end{aligned}
$$
Then the part of the circuit in the second dashed box maps the four Bell states of the first two qubits to the corresponding states from the computational basis:
$$
  \begin{aligned}
    &\ket{00} \otimes (\alpha\ket{0} + \beta\ket{1})
  \\+ &\ket{01} \otimes (\alpha\ket{1} + \beta\ket{0})
  \\+ &\ket{10} \otimes (\alpha\ket{0} - \beta\ket{1})
  \\+ &\ket{11} \otimes (\alpha\ket{1} - \beta\ket{0}).
  \end{aligned}
$$
Upon performing the standard measurement and learning the values of $x$ and $y$, we choose one of the four following transformations depending on these values:
\begin{equation}
  \begin{array}{ll}
    00 \mapsto \id
    &\quad 01 \mapsto X
  \\[1em]
    10 \mapsto Z
    &\quad 11 \mapsto ZX
  \end{array}
(\#eq:teleportation-transformations)
\end{equation}
(e.g. if $x=0$ and $y=1$, then we choose $X$).
We then apply this transformation to the third qubit, which restores the original state of the first qubit.

If you understand how this circuit works then you are ready for quantum teleportation.
Here is a dramatic version.


> Suppose three qubits, which look very similar, are initially in the possession of an absent-minded Oxford student, Alice.
> The first qubit is in a precious quantum state and this state is needed urgently for an experiment in Cambridge.
> The other two qubits are entangled, in the $\ket{\psi_{00}}$ state. Alice's colleague, Bob, pops in to collect the qubit.
> Once he is gone, Alice realises that, by mistake, she gave him not the first but the third qubit: the one which is entangled with the second qubit.
> 
> ```{r, engine='tikz',fig.width=4}
> \newcommand{\ket}[1]{|#1\rangle}
> \begin{tikzpicture}
>   \draw (0,0) circle (0.25cm) node {2};
>   \draw (0,0.75) circle (0.25cm) node {1};
>   \node at (0,-0.75) {Alice,};
>   \node at (0,-1.1) {in Oxford};
>   %
>   \draw (5,0) circle (0.25cm) node {3};
>   \node at (5,-0.75) {Bob,};
>   \node at (5,-1.1) {in Cambridge};
>   %
>   \draw [<->,dashed] (0.5,0) to node [above] {\small$\frac{1}{\sqrt2}(\ket{00}+\ket{11})$} (4.5,0);
> \end{tikzpicture}
> ```
> 
> The situation seems to be hopeless --- Alice does not know the quantum state of the first qubit, and Bob is now miles away and her communication with him is limited to few bits.
> However, Alice and Bob are both very clever and they both diligently attended their "Introduction to Quantum Information Science" classes.
> Can Alice rectify her mistake and save Cambridge science?
> 
> Hmmm... (pause for thought)...
> 
> Of course: Alice can teleport the state of the first qubit!
> She performs the Bell measurement on the first two qubits, which gives her two binary digits, $x$ and $y$.
> She then broadcasts $x$ and $y$ to Bob, who chooses the corresponding transformation, as in \@ref(eq:teleportation-transformations), performs it, and recovers the original state.






### Thou shalt not clone

**!!!TODO!!!**






## Why qubits, subsystems, and entanglement?

One question that is rather natural to ask at this point is the following:

> If entanglement is so fragile and difficult to control, then why bother?
> Why not perform the whole computation in one physical system that has as many quantum states as we normally have labels for the states of qubits, so that we can label these quantum states in the same way as we normally label the qubits, and give _them_ computational meaning?

This suggestion, although possible, gives a very inefficient way of representing data (it is describing the **unary encoding**).
For serious computations _we need subsystems_.
Here is why.

Suppose you have $n$ physical objects, and each object has $k$ distinguishable states.
If you can access each object _separately_ and put it into any of the $k$ states, then, with only $n$ operations, you can prepare any of the $k^{n}$ different configurations of the combined systems.
Without any loss of generality, let us take $k=2$ and refer to each object of this type as a **physical bit**.
We label the two states of a physical bit as $0$ and $1$.
Any collection of $n$ physical bits can be prepared in $2^{n}$ different configurations, which can be used to store up to $2^{n}$ messages/binary strings/different numbers.
In order to represent numbers from $0$ to $N-1$ we just have to choose $n$ such that $N\leq 2^n$.

Suppose the two states in the physical bit are separated by the energy difference $\Delta E$.
Then a preparation of any particular configuration will cost no more than $E=n \Delta E=(\log_2 N)\Delta E$ units of energy.

In contrast, if we choose to encode $N$ configurations into one chunk of matter, say, into the first $N$ energy states of a single harmonic oscillator with the interstate energy separation $\Delta E$ then, in the worst case, one has to use $E=N\Delta E$ units of energy, e.g. to go from the ground state (labelled as $0$) to the most excited state (labelled as $N$).
For large $N$ this gives an exponential gap in the energy expenditure between the binary encoding using physical bits and unary encoding, using energy levels of harmonic oscillators.

One can, of course, try to switch from harmonic oscillators to quantum systems which have a finite spread in the energy spectrum.
For example, by operating on the energy states of the hydrogen atom one can encode any number from $0$ to $N-1$, and one is guaranteed not to spend more than $E_{\mathrm{max}}=$ $13.6\,\mathrm{eV}$ (otherwise the atom is ionised).
The snag is that, in this case, some of the electronic states will be separated by the energy difference to the order of $E_{\mathrm{max}}/N$, and to drive the system selectively from one state to another one has to tune into the frequency $E_{\mathrm{max}}/\hbar N$, which requires a sufficiently long wave-packet (so that the frequency is well defined), and consequently the
interaction time is of order $N(\hbar/E_{\mathrm{max}})$.

That is, we have to trade energy for time.

It turns out that whichever way we try to represent the number $N$ using the unary encoding (i.e. using $N$ different states of a single chunk of matter), we end up depleting our physical resources (such as energy, time, space) at a much greater rate than in the case when we use subsystems.
This plausibility argument indicates that, for efficient processing of information, the system must be divided into subsystems --- for example, into physical bits.
